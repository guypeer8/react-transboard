"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireWildcard(require("react")),_semanticUiReact=require("semantic-ui-react"),_styledComponents=_interopRequireDefault(require("styled-components")),_TranslationNavigator=_interopRequireDefault(require("./Components/TranslationNavigator")),_TranslationSection=_interopRequireDefault(require("./Components/TranslationSection")),_TranslationSetup=_interopRequireDefault(require("./Components/TranslationSetup")),_WidthAdjuster=_interopRequireDefault(require("./Components/WidthAdjuster")),_CloseIcon=_interopRequireDefault(require("./Components/CloseIcon")),_const=require("./const"),_utils=require("./utils"),_Store=require("./Providers/Store"),_hooks=require("./hooks");function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var d=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(a,c):{};d.get||d.set?Object.defineProperty(b,c,d):b[c]=a[c]}return b.default=a,b}function _templateObject(){var a=_taggedTemplateLiteral(["\n    max-height: 880px;\n    min-height: 440px;\n    position: fixed;\n    bottom: 0;\n    right: 0;\n    overflow: auto;\n    background: black;\n    color: white;\n    padding: 25px 30px;\n    z-index: 1;\n    width: ","%;\n    display: ",";\n"]);return _templateObject=function(){return a},a}function _taggedTemplateLiteral(a,b){return b||(b=a.slice(0)),Object.freeze(Object.defineProperties(a,{raw:{value:Object.freeze(b)}}))}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null==arguments[b]?{}:arguments[b],d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){_defineProperty(a,b,c[b])})}return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}function _arrayWithHoles(a){if(Array.isArray(a))return a}var timeoutByLocale={},Translator=_react.default.memo(function(){var a=(0,_Store.getStore)(),b=a.translationState,c=a.dispatchTranslation,d=a.___development,e=b.base,f=b.translating_locale,g=b.translatable_locales,h=b.translations,i=_const.LOCALES.map(function(a){return{key:a,value:a,text:a}}),j=i.filter(function(a){var b=a.text;return b!==e});j.forEach(function(a){return timeoutByLocale[a]=null});var k=(0,_react.useState)(!0),l=_slicedToArray(k,2),m=l[0],n=l[1],o=(0,_react.useState)(50),p=_slicedToArray(o,2),q=p[0],r=p[1],s=(0,_react.useState)(!1),t=_slicedToArray(s,2),u=t[0],v=t[1],w=(0,_react.useState)(_const.TRANSLATE_BUTTON.PRE),x=_slicedToArray(w,2),y=x[0],z=x[1],A=(0,_hooks.useTranslationsTracker)(),B=A.localeTranslations,C=A.changedByLocale,D=(0,_react.useState)(!1),E=_slicedToArray(D,2),F=E[0],G=E[1],H=!F&&1<j.length,I=u||!f||0===g.length,J=function(){z(_const.TRANSLATE_BUTTON.POST),timeoutByLocale[f]=window.setTimeout(function(){timeoutByLocale[f]&&(window.clearTimeout(timeoutByLocale[f]),timeoutByLocale[f]=null);var a=_slicedToArray(C[f],2),b=a[1];b(!1),z(_const.TRANSLATE_BUTTON.PRE)},1e3)};return(0,_react.useEffect)(function(){window.localStorage.setItem(_const.TRANSLATED_LOCALE_KEY,f),c({type:"SET_TRANSLATIONS",translations:(0,_utils.buildTranslations)(h,g)})},[f]),(0,_react.useEffect)(function(){e&&window.localStorage.setItem(_const.BASE_LOCALE_KEY,e)},[e]),(0,_react.useEffect)(function(){g&&window.localStorage.setItem(_const.TRANSLATABLE_LOCALES_KEY,JSON.stringify(g))},[g]),d?_react.default.createElement(MainContainer,{width:q,visible:m},_react.default.createElement(_CloseIcon.default,{onClose:function(){return n(!1)}}),I&&_react.default.createElement(_TranslationSetup.default,{locales:i,unused_locales:j,isAddingTranslatable:u,setIsAddingTranslatable:v}),!I&&_react.default.createElement("div",null,_react.default.createElement(_TranslationNavigator.default,{showTranslatedJson:F,toggleTranslatedJson:G,setIsAddingTranslatable:v}),H&&_react.default.createElement("div",null,_react.default.createElement(_semanticUiReact.Button.Group,null,g.map(function(a){return _react.default.createElement(_semanticUiReact.Button,{key:a,active:f===a,onClick:function(){return c({type:"SET_TRANSLATING_LOCALE",translating_locale:a})}},a)}))),_react.default.createElement(_WidthAdjuster.default,{width:q,setWidth:r}),F&&_react.default.createElement("pre",null,JSON.stringify(h,null,4)),e===f&&_react.default.createElement(_semanticUiReact.Message,{size:"small"},_react.default.createElement(_semanticUiReact.Icon,{name:"exclamation circle"}),"In order to translate, navigate to a none base locale."),!F&&e!==f&&_react.default.createElement(_TranslationSection.default,{showTranslatedJson:F,localeTranslations:B[f]||{},localeChangeIndicator:C[f],translateButtonText:y,onSaveTranslation:function(){var a=B[f],b=_defineProperty({},f,_objectSpread({},h[f],(0,_utils.extractTranslation)(a)));c({type:"SET_TRANSLATIONS",translations:(0,_utils.serializeTranslations)(b)}),J()}}))):null}),_default=Translator;exports.default=_default;var MainContainer=_styledComponents.default.div(_templateObject(),function(a){return a.width},function(a){return a.visible?"":"none"});